{% if items | length > 0 %}
<hr>
{% endif %}

<div class="grid-x grid-padding-x">

  {% if items | length > 0 %}
  <div class="cell large-9 cart-shipping-estimates">
    <h3>Shipping Rates Calculator</h3>

    <div class="grid-x grid-padding-x">
      <label class="cell large-4">
        <span>Country</span>
        <select name="countryId" data-state-selector="#shipping-estimate-state-id" data-current-state="{{ shippingInfo.shop_state_id }}">
          {% for country in countries %}
          <option value="{{ country.id }}" {{ option_state(country.id, shippingInfo.shop_country_id) }}>{{ country.name }}</option>
          {% endfor %}
        </select>
      </label>

      <label class="cell large-4">
        <span>State</span>
        <select id="shipping-estimate-state-id" name="stateId" data-ajax-refresh>
          {{ partial('shop-stateoptions', { 'states': states, 'selected': shippingInfo.shop_state_id }) }}
        </select>
      </label>

      <label class="cell large-2">
        <span>Zip Code</span>
        <input name="postalCode" type="text" value="{{ shippingInfo.postalCode }}"/>
      </label>
    </div>

    <a class="button" data-ajax-handler="shop:onEvalShippingRate"
       data-ajax-update=".shipping-estimates=shipping-estimates">
      Calculate
    </a>

    <div class="shipping-estimates"><!-- Will be populated after Calculate button clicked --></div>
  </div>

  <div class="cell large-3 cart-totals">
    <div class="grid-x grid-padding-x">

      <div class="cell large-6 title-cell">
        Subtotal
      </div>
      <div class="cell large-6 value-cell">
        {{ cart.getSubtotalNoTax() | currency }}
      </div>

      <div class="cell large-6 title-cell">
        Discount
      </div>
      <div class="cell large-6 value-cell">
        {{ cart.getDiscountTotal() | currency }}
      </div>

      {% if shipping.streetAddressLine1 %}
      <div class="cell large-6 title-cell">
        Tax
      </div>
      <div class="cell large-6 value-cell">
        {{ cart.getTotalTax() | currency }}
      </div>
      {% endif %}

      <div class="cell large-6 title-cell total-cell">
        Total
      </div>
      <div class="cell large-6 value-cell total-cell">
        {{ cart.getTotal() | currency }}
      </div>

    </div>
  </div>
  {% endif %}

  <div class="cell large-12 cart-footer">
    <hr>
    <div class="grid-x grid-padding-x align-justify">
      <div class="cell shrink footer-left">
        <a class="button hollow" href="/products">Continue Shopping</a>
      </div>
      <div class="cell shrink footer-right">
        {% if items | length > 0 %}
        <label class="input-group">
          <span class="input-group-label">Coupon Code</span>
          <input type="text" name="coupon" class="input-group-field" value="{{ coupon_code }}"/>
        </label>
        <input type="submit" class="button hollow" value="Apply Changes"/>
        <a class="button" href="/checkout">Checkout</a>
        {% endif %}
      </div>
    </div>
  </div>
</div>